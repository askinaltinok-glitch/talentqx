<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\InterviewTemplate;
use Illuminate\Support\Str;

class RuInterviewTemplatesSeeder extends Seeder
{
    public function run(): void
    {
        $templates = [
            $this->genericTemplate(),
            $this->retailCashierTemplate(),
            $this->customerSupportTemplate(),
            $this->salesAssociateTemplate(),
            $this->warehousePickerTemplate(),
        ];

        foreach ($templates as $tpl) {
            // Skip if already exists
            $exists = InterviewTemplate::where('language', 'ru')
                ->where('position_code', $tpl['position_code'])
                ->where('version', 'v1')
                ->where('is_active', true)
                ->exists();

            if ($exists) {
                $this->command->info("Skipping {$tpl['position_code']} (ru) — already exists.");
                continue;
            }

            InterviewTemplate::create([
                'id' => Str::uuid()->toString(),
                'version' => 'v1',
                'language' => 'ru',
                'position_code' => $tpl['position_code'],
                'title' => $tpl['title'],
                'template_json' => json_encode($tpl['json'], JSON_UNESCAPED_UNICODE),
                'is_active' => true,
            ]);

            $this->command->info("Created {$tpl['position_code']} (ru)");
        }
    }

    private function genericTemplate(): array
    {
        return [
            'position_code' => '__generic__',
            'title' => 'Универсальный шаблон интервью (русский)',
            'json' => [
                'version' => 'v1',
                'language' => 'ru',
                'generic_template' => [
                    'questions' => [
                        [
                            'slot' => 1,
                            'competency' => 'communication',
                            'question' => 'Расскажите о ситуации, когда вам нужно было объяснить сложную тему простыми словами. Что вы сделали и каков был результат?',
                            'method' => 'STAR',
                            'scoring_rubric' => [
                                '1' => 'Не смог объяснить, отсутствие перспективы слушателя, запутанное и бессвязное изложение',
                                '2' => 'Базовая информация передана, но без структуры, не адаптировано под слушателя',
                                '3' => 'Понятное изложение, базовая структура, открытость к обратной связи',
                                '4' => 'Чёткое и организованное изложение, адаптация под уровень слушателя, готовность отвечать на вопросы',
                                '5' => 'Отличная структура, эмпатичное изложение с фокусом на слушателя, эффективная обратная связь',
                            ],
                            'positive_signals' => [
                                'Уточнил уровень знаний слушателя',
                                'Использовал примеры и аналогии',
                                'Проверял понимание',
                                'Менял подход на основе обратной связи',
                            ],
                            'red_flag_hooks' => [
                                [
                                    'code' => 'RF_AVOID',
                                    'trigger_guidance' => 'Уклонение от коммуникационной ответственности: «это не моя работа», «пусть кто-то другой разбирается»',
                                    'severity' => 'medium',
                                ],
                            ],
                        ],
                        [
                            'slot' => 2,
                            'competency' => 'accountability',
                            'question' => 'Расскажите о ситуации на работе, когда вы допустили ошибку или что-то пошло не так. Как вы с этим справились?',
                            'method' => 'BEI',
                            'scoring_rubric' => [
                                '1' => 'Отрицал ошибку или полностью обвинял других, не брал ответственность',
                                '2' => 'Признал ошибку, но не предпринял действий для исправления, оставался пассивным',
                                '3' => 'Признал ошибку и предпринял базовые корректирующие шаги',
                                '4' => 'Полностью взял ответственность, проактивно нашёл решение, информировал заинтересованных лиц',
                                '5' => 'Принял ошибку, разработал системное решение, предложил улучшение процесса',
                            ],
                            'positive_signals' => [
                                'Чётко признал ошибку',
                                'Не перекладывал вину на других',
                                'Описал конкретные корректирующие действия',
                                'Поделился извлечёнными уроками',
                            ],
                            'red_flag_hooks' => [
                                [
                                    'code' => 'RF_BLAME',
                                    'trigger_guidance' => 'Постоянные ссылки на внешние факторы: «команда меня не поддержала», «руководитель дал неправильное указание»',
                                    'severity' => 'high',
                                ],
                                [
                                    'code' => 'RF_INCONSIST',
                                    'trigger_guidance' => 'Противоречия в рассказе: сначала обвиняет других, потом берёт ответственность; противоречивые детали',
                                    'severity' => 'high',
                                ],
                            ],
                        ],
                        [
                            'slot' => 3,
                            'competency' => 'teamwork',
                            'question' => 'Расскажите о проекте, где вы работали с коллегами, имевшими разные точки зрения. Как вы управляли различиями во мнениях?',
                            'method' => 'STAR',
                            'scoring_rubric' => [
                                '1' => 'Избегал командной работы или навязывал своё мнение, не искал консенсуса',
                                '2' => 'Пассивное участие, не высказывал мнения или игнорировал конфликт',
                                '3' => 'Выслушивал разные мнения, предпринимал базовые попытки достичь согласия',
                                '4' => 'Активно интегрировал различные перспективы, создавал конструктивную атмосферу обсуждения',
                                '5' => 'Создал синергию из различий, обеспечил участие каждого, направил к общей цели',
                            ],
                            'positive_signals' => [
                                'Активно спрашивал мнение других',
                                'Был готов изменить свою точку зрения',
                                'Конструктивно управлял конфликтом',
                                'Ставил успех команды выше личного',
                            ],
                            'red_flag_hooks' => [
                                [
                                    'code' => 'RF_EGO',
                                    'trigger_guidance' => 'Присвоение командных достижений: «на самом деле они реализовали мою идею», «без меня они бы не справились»',
                                    'severity' => 'medium',
                                ],
                                [
                                    'code' => 'RF_AGGRESSION',
                                    'trigger_guidance' => 'Унизительные высказывания о членах команды: оскорбления, личные выпады, агрессивный тон',
                                    'severity' => 'critical',
                                ],
                            ],
                        ],
                        [
                            'slot' => 4,
                            'competency' => 'stress_resilience',
                            'question' => 'Расскажите о периоде, когда вы работали под сильным давлением с несколькими приоритетами одновременно. Как вы справились?',
                            'method' => 'BEI',
                            'scoring_rubric' => [
                                '1' => 'Не выдержал давления, не смог завершить задачи, паника или избегание',
                                '2' => 'Завершил с трудом, без стратегии управления стрессом, реактивный подход',
                                '3' => 'Выполнил задачи, базовая расстановка приоритетов, умеренное управление стрессом',
                                '4' => 'Эффективная расстановка приоритетов, сохранял спокойствие, системный подход, качество сохранено',
                                '5' => 'Выдающаяся работа под давлением, успокаивал других, использовал стресс как мотивацию',
                            ],
                            'positive_signals' => [
                                'Описал конкретный метод расстановки приоритетов',
                                'Продемонстрировал эмоциональный контроль',
                                'При необходимости просил помощи',
                                'Извлёк уроки на будущее',
                            ],
                            'red_flag_hooks' => [
                                [
                                    'code' => 'RF_UNSTABLE',
                                    'trigger_guidance' => 'Неконтролируемые реакции на стресс: «я взорвался», «я ушёл», «я полностью потерял контроль»',
                                    'severity' => 'medium',
                                ],
                                [
                                    'code' => 'RF_AVOID',
                                    'trigger_guidance' => 'Систематическое уклонение от стрессовых ситуаций: «это не моя работа», «я не беру на себя такую ответственность»',
                                    'severity' => 'medium',
                                ],
                            ],
                        ],
                        [
                            'slot' => 5,
                            'competency' => 'adaptability',
                            'question' => 'Как вы адаптировались, когда на вашем рабочем месте произошли неожиданные изменения? Приведите пример.',
                            'method' => 'STAR',
                            'scoring_rubric' => [
                                '1' => 'Сопротивлялся изменениям, не адаптировался, жаловался или мешал',
                                '2' => 'Адаптировался нехотя, сохранял негативное отношение',
                                '3' => 'Принял изменения, адаптировался в разумные сроки',
                                '4' => 'Быстро принял изменения, эффективно работал в новых условиях, помогал другим адаптироваться',
                                '5' => 'Превратил изменения в возможность, вносил проактивные предложения, взял роль лидера изменений',
                            ],
                            'positive_signals' => [
                                'Стремился понять причины изменений',
                                'Быстро освоил новые навыки',
                                'Сохранял позитивное отношение',
                                'Поддерживал адаптацию других',
                            ],
                            'red_flag_hooks' => [
                                [
                                    'code' => 'RF_AVOID',
                                    'trigger_guidance' => 'Уклонение и отторжение изменений: «я этим не занимаюсь», «не моя работа — учить новую систему»',
                                    'severity' => 'medium',
                                ],
                            ],
                        ],
                        [
                            'slot' => 6,
                            'competency' => 'learning_agility',
                            'question' => 'Расскажите о ситуации, когда вам нужно было быстро освоить совершенно новую тему или навык. Как вы подошли к этому?',
                            'method' => 'STAR',
                            'scoring_rubric' => [
                                '1' => 'Нежелание учиться, пассивное отношение, зависимость от других',
                                '2' => 'Освоил на базовом уровне, но не углубился, делал только необходимый минимум',
                                '3' => 'Активные усилия по обучению, использовал стандартные ресурсы, освоил в разумные сроки',
                                '4' => 'Быстрое и эффективное обучение, использовал несколько источников, сразу применил на практике',
                                '5' => 'Выдающаяся скорость обучения, улучшил изученное, обучил других',
                            ],
                            'positive_signals' => [
                                'Использовал несколько источников обучения',
                                'Не стеснялся задавать вопросы',
                                'Применял знания на практике',
                                'Выражал удовольствие от процесса обучения',
                            ],
                            'red_flag_hooks' => [
                                [
                                    'code' => 'RF_AVOID',
                                    'trigger_guidance' => 'Уклонение от ответственности за обучение: «не моя работа — учить новое», «пусть кто-то другой научит»',
                                    'severity' => 'medium',
                                ],
                            ],
                        ],
                        [
                            'slot' => 7,
                            'competency' => 'integrity',
                            'question' => 'Расскажите о ситуации, когда вы столкнулись с этически сложным решением. Как вы поступили?',
                            'method' => 'BEI',
                            'scoring_rubric' => [
                                '1' => 'Описал неэтичное поведение или нормализовал нарушение правил',
                                '2' => 'Распознал этическую дилемму, но не действовал, оставался пассивным',
                                '3' => 'Поступил правильно, но только потому что обязан; внутренняя мотивация неясна',
                                '4' => 'Придерживался этических принципов, принял правильное решение даже в сложной ситуации, последовательное поведение',
                                '5' => 'Проявил этическое лидерство, направлял других к правильному поведению, рисковал ради защиты правого дела',
                            ],
                            'positive_signals' => [
                                'Описал чёткую и последовательную этическую позицию',
                                'Поступил правильно, несмотря на личные издержки',
                                'Подчёркивал прозрачность и честность',
                                'Противостоял неэтичному давлению',
                            ],
                            'red_flag_hooks' => [
                                [
                                    'code' => 'RF_INCONSIST',
                                    'trigger_guidance' => 'Этическая непоследовательность: ситуативные правила, нормализация «все так делают»',
                                    'severity' => 'high',
                                ],
                                [
                                    'code' => 'RF_BLAME',
                                    'trigger_guidance' => 'Перекладывание вины за этические нарушения: «руководитель заставил», «система так устроена»',
                                    'severity' => 'high',
                                ],
                            ],
                        ],
                        [
                            'slot' => 8,
                            'competency' => 'role_competence',
                            'question' => 'Расскажите об опыте, когда вы выполняли одно из ключевых требований данной должности. Какой подход вы использовали и каков был результат?',
                            'method' => 'STAR',
                            'scoring_rubric' => [
                                '1' => 'Нет релевантного опыта или очень поверхностный, показал непонимание основных требований',
                                '2' => 'Ограниченный опыт, знает базовые понятия, но слаб в применении',
                                '3' => 'Достаточный опыт, правильно применял стандартные процессы, приемлемые результаты',
                                '4' => 'Сильный опыт, качественные и измеримые результаты, улучшил процесс',
                                '5' => 'Выдающаяся результативность, разработал инновационные подходы, способен обучать других',
                            ],
                            'positive_signals' => [
                                'Поделился конкретными измеримыми результатами',
                                'Правильно и логично описал этапы процесса',
                                'Объяснил, как решал возникшие проблемы',
                                'Привёл примеры непрерывного совершенствования',
                            ],
                            'red_flag_hooks' => [
                                [
                                    'code' => 'RF_INCONSIST',
                                    'trigger_guidance' => 'Преувеличение компетенции: противоречия при уточняющих вопросах, расплывчатые ответы при просьбе объяснить',
                                    'severity' => 'high',
                                ],
                                [
                                    'code' => 'RF_EGO',
                                    'trigger_guidance' => 'Нереалистичная самоуверенность: «я лучше всех справляюсь с этой работой», «никто не знает столько, сколько я»',
                                    'severity' => 'medium',
                                ],
                            ],
                        ],
                    ],
                ],
                'positions' => [],
            ],
        ];
    }

    private function retailCashierTemplate(): array
    {
        return [
            'position_code' => 'retail_cashier',
            'title' => 'Шаблон интервью — Кассир (русский)',
            'json' => [
                'version' => 'v1',
                'language' => 'ru',
                'position' => [
                    'position_code' => 'retail_cashier',
                    'title_tr' => 'Kasiyer',
                    'title_en' => 'Cashier',
                    'title_ru' => 'Кассир',
                    'category' => 'Розничная торговля',
                    'skill_gate' => [
                        'gate' => 45,
                        'action' => 'HOLD',
                        'safety_critical' => false,
                    ],
                ],
                'questions' => [
                    [
                        'slot' => 1,
                        'competency' => 'communication',
                        'question' => 'Расскажите о ситуации, когда у вас возникли трудности в общении с клиентом. Как вы решили проблему?',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Не смог общаться с клиентом, защитная или безразличная позиция',
                            '2' => 'Базовое общение, но неэффективное, клиент остался неудовлетворён',
                            '3' => 'Выслушал проблему и предложил стандартное решение, приемлемая коммуникация',
                            '4' => 'Слушал с эмпатией, дал чёткое объяснение, клиент остался доволен',
                            '5' => 'Отличная коммуникация с клиентом, превратил сложную ситуацию в возможность, создал лояльность',
                        ],
                        'positive_signals' => [
                            'Активно слушал клиента',
                            'Был терпелив и уважителен',
                            'Ориентировался на решение',
                            'Получал обратную связь',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AGGRESSION',
                                'trigger_guidance' => 'Унизительные высказывания о клиентах: оскорбления, снисходительность, «глупый клиент»',
                                'severity' => 'critical',
                            ],
                        ],
                    ],
                    [
                        'slot' => 2,
                        'competency' => 'accountability',
                        'question' => 'Как вы поступили, когда допустили ошибку на кассе или обнаружилась недостача?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Скрыл ошибку или свалил на другого, не взял ответственность',
                            '2' => 'Признал ошибку, но не предложил решение, остался пассивным',
                            '3' => 'Сообщил об ошибке и действовал по процедуре',
                            '4' => 'Сразу сообщил, выяснил причину, предпринял корректирующие действия',
                            '5' => 'Полная прозрачность, анализ первопричин, предложил меры по предотвращению',
                        ],
                        'positive_signals' => [
                            'Немедленно сообщил об ошибке',
                            'Извинился и взял ответственность',
                            'Предпринял действия для исправления',
                            'Следовал процедуре',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_BLAME',
                                'trigger_guidance' => 'Перекладывание вины за недостачу: «из-за системной ошибки», «из-за клиента»',
                                'severity' => 'high',
                            ],
                            [
                                'code' => 'RF_INCONSIST',
                                'trigger_guidance' => 'Противоречивые объяснения: противоречивая информация о суммах или событиях',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                    [
                        'slot' => 3,
                        'competency' => 'teamwork',
                        'question' => 'Расскажите, как вы поддержали коллег в напряжённый рабочий день.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Сосредоточился только на своей работе, не поддержал команду',
                            '2' => 'Помогал по просьбе, но не проявлял инициативу',
                            '3' => 'Заметил потребности команды и оказал базовую поддержку',
                            '4' => 'Проактивно предлагал помощь, делился нагрузкой',
                            '5' => 'Обеспечивал координацию команды, балансировал нагрузку, повышал мотивацию',
                        ],
                        'positive_signals' => [
                            'Предлагал помощь',
                            'Проявлял гибкость',
                            'Подчёркивал командный успех',
                            'Поддерживал коммуникацию',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_EGO',
                                'trigger_guidance' => 'Выпячивание личных достижений: «я работал больше всех», «без меня бы не справились»',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 4,
                        'competency' => 'stress_resilience',
                        'question' => 'Как вы себя ведёте, когда на кассе длинная очередь и клиенты нервничают?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Запаниковал и начал ошибаться или грубо обращался с клиентами',
                            '2' => 'Выглядел напряжённым, замедлился, проявлял раздражение',
                            '3' => 'Старался сохранять спокойствие, работал в стандартном темпе',
                            '4' => 'Сохранял самообладание, баланс скорости и точности, информировал клиентов',
                            '5' => 'Выдающаяся работа под давлением, успокаивал клиентов, организовывал команду',
                        ],
                        'positive_signals' => [
                            'Был спокоен и контролировал ситуацию',
                            'Информировал клиентов',
                            'Поддерживал скорость и точность',
                            'Просил помощь при необходимости',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_UNSTABLE',
                                'trigger_guidance' => 'Неконтролируемые реакции на стресс: «я вспылил», «я расплакался», «я всё бросил и ушёл»',
                                'severity' => 'medium',
                            ],
                            [
                                'code' => 'RF_AGGRESSION',
                                'trigger_guidance' => 'Грубые реакции на клиентов или коллег в стрессовой ситуации',
                                'severity' => 'critical',
                            ],
                        ],
                    ],
                    [
                        'slot' => 5,
                        'competency' => 'adaptability',
                        'question' => 'Как вы адаптировались, когда была внедрена новая кассовая система или изменились процедуры продаж?',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Сопротивлялся изменениям, продолжал использовать старый метод',
                            '2' => 'Учился неохотно, жаловался, медленная адаптация',
                            '3' => 'Принял изменения, освоил в разумные сроки',
                            '4' => 'Быстро адаптировался, увидел преимущества новой системы',
                            '5' => 'Принял изменения, помог другим адаптироваться, предложил улучшения',
                        ],
                        'positive_signals' => [
                            'Открыт к обучению',
                            'Задавал вопросы',
                            'Практиковался',
                            'Помогал другим',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Уклонение от изменений и обучения: «не моя работа — учить новую систему»',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 6,
                        'competency' => 'learning_agility',
                        'question' => 'Расскажите о ситуации в розничной торговле, когда вам нужно было быстро изучить новую товарную группу или акцию.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Не предпринимал усилий для обучения, давал клиентам неверную информацию',
                            '2' => 'Освоил основы, но недостаточно, слаб в деталях',
                            '3' => 'Изучил необходимую информацию, давал клиентам верную информацию',
                            '4' => 'Быстро освоил, предоставлял клиентам подробную информацию, увеличил продажи',
                            '5' => 'Стал экспертом, обучил команду, получил положительные отзывы от клиентов',
                        ],
                        'positive_signals' => [
                            'Проявлял инициативу в изучении',
                            'Делал записи',
                            'Задавал вопросы',
                            'Делился знаниями',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Уклонение от обучения: «не моя работа — знать информацию о товарах»',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 7,
                        'competency' => 'integrity',
                        'question' => 'Что вы сделали, когда обнаружили лишние деньги или расхождение в товаре на кассе? Или как бы вы поступили в такой ситуации?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Подразумевал, что не стал бы сообщать или воспользовался бы расхождением',
                            '2' => 'Не уверен, как поступить, нет чёткой этической позиции',
                            '3' => 'Заявил, что поступит правильно, но мотивация неясна',
                            '4' => 'Чётко описал процедуру отчётности и исправления, последовательный этический подход',
                            '5' => 'Твёрдая этическая позиция, подкреплённая примерами, последовательность в других ситуациях',
                        ],
                        'positive_signals' => [
                            'Немедленный рефлекс сообщить',
                            'Акцент на честности',
                            'Знание процедур',
                            'Последовательный этический подход',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_INCONSIST',
                                'trigger_guidance' => 'Этическая непоследовательность: «зависит от ситуации», «если сумма маленькая, это неважно»',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                    [
                        'slot' => 8,
                        'competency' => 'role_competence',
                        'question' => 'Расскажите о ваших ежедневных кассовых операциях. Что вы делаете при открытии, во время операций и при закрытии?',
                        'method' => 'Direct',
                        'scoring_rubric' => [
                            '1' => 'Не знает базовые кассовые операции, нет опыта или очень ограниченный',
                            '2' => 'Знает некоторые операции, но есть пробелы, нуждается в руководстве',
                            '3' => 'Может выполнять стандартные операции: наличные, банковская карта, возврат',
                            '4' => 'Знает все операции, может применять акции, устранять неполадки',
                            '5' => 'Экспертный уровень: сложные операции, может обучать, устранение системных проблем',
                        ],
                        'positive_signals' => [
                            'Правильно перечислил этапы операций',
                            'Знал протоколы безопасности',
                            'Привёл пример решения проблемы',
                            'Ориентирован на удовлетворённость клиента',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_INCONSIST',
                                'trigger_guidance' => 'Преувеличение опыта: неверные ответы на базовые вопросы, расплывчатость при запросе деталей',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                ],
            ],
        ];
    }

    private function customerSupportTemplate(): array
    {
        return [
            'position_code' => 'customer_support',
            'title' => 'Шаблон интервью — Специалист службы поддержки (русский)',
            'json' => [
                'version' => 'v1',
                'language' => 'ru',
                'position' => [
                    'position_code' => 'customer_support',
                    'title_tr' => 'Müşteri Hizmetleri Temsilcisi',
                    'title_en' => 'Customer Support Representative',
                    'title_ru' => 'Специалист службы поддержки клиентов',
                    'category' => 'Обслуживание клиентов',
                    'skill_gate' => [
                        'gate' => 55,
                        'action' => 'HOLD',
                        'safety_critical' => false,
                    ],
                ],
                'questions' => [
                    [
                        'slot' => 1,
                        'competency' => 'communication',
                        'question' => 'Как вы общаетесь с рассерженным или недовольным клиентом? Расскажите о сложном клиентском опыте.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Защитная или грубая позиция по отношению к клиенту',
                            '2' => 'Слушал, но не проявлял эмпатию',
                            '3' => 'Терпеливо слушал, предложил стандартное решение',
                            '4' => 'Проявил эмпатию, обеспечил удовлетворённость',
                            '5' => 'Превратил сложную ситуацию в возможность, создал лояльность клиента',
                        ],
                        'positive_signals' => [
                            'Активное слушание',
                            'Эмпатичные высказывания',
                            'Спокойствие и профессионализм',
                            'Ориентация на решение',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AGGRESSION',
                                'trigger_guidance' => 'Грубые или унизительные высказывания о клиентах',
                                'severity' => 'critical',
                            ],
                        ],
                    ],
                    [
                        'slot' => 2,
                        'competency' => 'accountability',
                        'question' => 'Что вы сделали, когда дали клиенту неверную информацию или неправильно обработали жалобу?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Не признал ошибку, обвинил систему или клиента',
                            '2' => 'Признал ошибку, но не предложил решение',
                            '3' => 'Признал ошибку и следовал процедуре',
                            '4' => 'Проактивное исправление, обеспечил удовлетворённость клиента',
                            '5' => 'Предложил компенсацию, отслеживал результат, предложил улучшение процесса',
                        ],
                        'positive_signals' => [
                            'Взял ответственность',
                            'Немедленно начал действовать',
                            'Отслеживал работу с клиентом',
                            'Извлёк урок',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_BLAME',
                                'trigger_guidance' => 'Постоянные ссылки на внешние факторы',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                    [
                        'slot' => 3,
                        'competency' => 'teamwork',
                        'question' => 'Расскажите, как вы работали с другими отделами для решения сложной клиентской проблемы.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Не сотрудничал, перебрасывал проблему на других',
                            '2' => 'Базовая коммуникация, но слабая координация',
                            '3' => 'Связался с нужными людьми, решение найдено',
                            '4' => 'Проактивная координация, управлял процессом',
                            '5' => 'Наладил межотдельное взаимодействие, предложил системное улучшение',
                        ],
                        'positive_signals' => [
                            'Инициировал коммуникацию',
                            'Отслеживал процесс',
                            'Делился информацией',
                            'Ориентировался на результат',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Уклонение от ответственности, перекидывание проблемы на других',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 4,
                        'competency' => 'stress_resilience',
                        'question' => 'Как вы справлялись в периоды высокой нагрузки, когда приходилось работать с несколькими сложными клиентами подряд?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Выгорание, серьёзное падение производительности',
                            '2' => 'С трудом продолжал, стресс был заметен',
                            '3' => 'Поддерживал приемлемую производительность',
                            '4' => 'Оставался спокоен, профессионально подходил к каждому клиенту',
                            '5' => 'Позитивен даже под давлением, поддерживал команду',
                        ],
                        'positive_signals' => [
                            'Техника управления стрессом',
                            'Стратегия перерывов',
                            'Позитивное отношение',
                            'Управление энергией',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_UNSTABLE',
                                'trigger_guidance' => 'Потеря контроля под стрессом',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 5,
                        'competency' => 'adaptability',
                        'question' => 'Как вы адаптировались при внедрении новой CRM-системы или изменении процедур обслуживания клиентов?',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Сопротивлялся изменениям, настаивал на старых методах',
                            '2' => 'Вынужденно адаптировался',
                            '3' => 'Принял изменения, изучил',
                            '4' => 'Быстро адаптировался, увидел преимущества новой системы',
                            '5' => 'Возглавил изменения, обучал других',
                        ],
                        'positive_signals' => [
                            'Готовность учиться',
                            'Принял новую систему',
                            'Задавал вопросы',
                            'Давал обратную связь',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Систематическое уклонение от изменений',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 6,
                        'competency' => 'learning_agility',
                        'question' => 'Расскажите о ситуации, когда вам нужно было быстро изучить информацию о новом продукте или услуге.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Остался некомпетентным, давал клиентам неверную информацию',
                            '2' => 'Получил базовые знания',
                            '3' => 'Изучил достаточно информации',
                            '4' => 'Быстро глубоко изучил',
                            '5' => 'Стал экспертом, обучил команду',
                        ],
                        'positive_signals' => [
                            'Проактивное обучение',
                            'Эффективно использовал ресурсы',
                            'Делал заметки',
                            'Делился знаниями',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Уклонение от ответственности за обучение',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 7,
                        'competency' => 'integrity',
                        'question' => 'Как вы поступили, когда клиент попросил вас сделать что-то, противоречащее политике компании?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Согласился на нарушение политики',
                            '2' => 'Колебался',
                            '3' => 'Вежливо отказал',
                            '4' => 'Объяснил причину, предложил альтернативу',
                            '5' => 'Чёткая этическая позиция, при необходимости эскалировал',
                        ],
                        'positive_signals' => [
                            'Знает политику компании',
                            'Вежлив, но твёрд',
                            'Предложил альтернативу',
                            'Эскалация при необходимости',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_INCONSIST',
                                'trigger_guidance' => 'Ситуативное применение правил',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                    [
                        'slot' => 8,
                        'competency' => 'role_competence',
                        'question' => 'Как вы обычно ведёте обращение клиента от начала до конца? Опишите этапы: приём жалобы, исследование, решение и закрытие.',
                        'method' => 'Direct',
                        'scoring_rubric' => [
                            '1' => 'Не знает базовых процессов управления жалобами',
                            '2' => 'Знает некоторые этапы',
                            '3' => 'Может выполнить стандартный процесс',
                            '4' => 'Знает все этапы, управляет с эмпатией',
                            '5' => 'Эксперт: деэскалация, решение проблем, измерение удовлетворённости',
                        ],
                        'positive_signals' => [
                            'Правильно описал этапы процесса',
                            'Подчеркнул эмпатию',
                            'Описал этапы отслеживания и закрытия',
                            'Важность документирования',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_INCONSIST',
                                'trigger_guidance' => 'Преувеличение опыта',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                ],
            ],
        ];
    }

    private function salesAssociateTemplate(): array
    {
        return [
            'position_code' => 'sales_associate',
            'title' => 'Шаблон интервью — Продавец-консультант (русский)',
            'json' => [
                'version' => 'v1',
                'language' => 'ru',
                'position' => [
                    'position_code' => 'sales_associate',
                    'title_tr' => 'Mağaza Satış Temsilcisi',
                    'title_en' => 'Sales Associate',
                    'title_ru' => 'Продавец-консультант',
                    'category' => 'Розничная торговля',
                    'skill_gate' => [
                        'gate' => 50,
                        'action' => 'HOLD',
                        'safety_critical' => false,
                    ],
                ],
                'questions' => [
                    [
                        'slot' => 1,
                        'competency' => 'communication',
                        'question' => 'Как вы общаетесь с клиентом, рекомендуя товар? Расскажите об успешном опыте продажи.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Не смог наладить контакт с клиентом, монолог без слушания',
                            '2' => 'Базовое общение, но не понял потребности клиента',
                            '3' => 'Слушал клиента, предлагал стандартные варианты',
                            '4' => 'Активное слушание, анализ потребностей, персонализированная рекомендация',
                            '5' => 'Отличная коммуникация, доверительные отношения, повторная покупка',
                        ],
                        'positive_signals' => [
                            'Задавал открытые вопросы',
                            'Активно слушал клиента',
                            'Рекомендовал исходя из потребностей',
                            'Получал обратную связь',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AGGRESSION',
                                'trigger_guidance' => 'Навязчивый или унизительный подход к клиенту',
                                'severity' => 'critical',
                            ],
                        ],
                    ],
                    [
                        'slot' => 2,
                        'competency' => 'accountability',
                        'question' => 'Что вы делали, когда продали клиенту не тот товар или дали неверную информацию?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Не признал ошибку или обвинил клиента',
                            '2' => 'Признал ошибку, но не исправил',
                            '3' => 'Признал ошибку и предложил стандартное решение',
                            '4' => 'Немедленно принял корректирующие меры, обеспечил удовлетворённость клиента',
                            '5' => 'Проактивное решение, компенсация, восстановление доверия',
                        ],
                        'positive_signals' => [
                            'Немедленно признал ошибку',
                            'Извинился',
                            'Подошёл с фокусом на решение',
                            'Отследил результат',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_BLAME',
                                'trigger_guidance' => 'Перекладывание вины на систему, товар или клиента',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                    [
                        'slot' => 3,
                        'competency' => 'teamwork',
                        'question' => 'Расскажите, как вы работали с командой магазина для достижения общей цели.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Предпочитал работать один, не ладил с командой',
                            '2' => 'Работал в команде, но пассивно участвовал',
                            '3' => 'Вносил вклад в командные цели',
                            '4' => 'Активное сотрудничество, обмен знаниями, поддержка',
                            '5' => 'Мотивировал команду, обеспечивал координацию, подчёркивал общий успех',
                        ],
                        'positive_signals' => [
                            'Подчёркивал командный успех',
                            'Делился опытом и знаниями',
                            'Проявлял гибкость',
                            'Поддерживал коллег',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_EGO',
                                'trigger_guidance' => 'Выпячивание личных достижений, принижение вклада команды',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 4,
                        'competency' => 'stress_resilience',
                        'question' => 'Как вы работали в период интенсивных акций или распродаж? Как справлялись со стрессом?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Под стрессом падала производительность, увеличивались ошибки',
                            '2' => 'С трудом справлялся, стресс был заметен',
                            '3' => 'Приемлемая производительность, базовое управление стрессом',
                            '4' => 'Оставался спокоен, работал эффективно, позитивно общался с клиентами',
                            '5' => 'Выдающаяся работа под давлением, мотивировал команду',
                        ],
                        'positive_signals' => [
                            'Расставлял приоритеты',
                            'Сохранял спокойствие',
                            'Поддерживал позитивный настрой',
                            'Управлял энергией',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_UNSTABLE',
                                'trigger_guidance' => 'Неконтролируемые реакции под стрессом',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 5,
                        'competency' => 'adaptability',
                        'question' => 'Как вы адаптировались, когда в магазине появилась новая товарная группа или техника продаж?',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Сопротивлялся изменениям, продолжал по-старому',
                            '2' => 'Вынужденно адаптировался, неохотно',
                            '3' => 'Принял изменения, освоил за разумное время',
                            '4' => 'Быстро адаптировался, принял новый метод',
                            '5' => 'Превратил изменения в возможность, обучал других',
                        ],
                        'positive_signals' => [
                            'Открыт к обучению',
                            'Пробовал новые методы',
                            'Получал обратную связь',
                            'Помогал другим',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Уклонение от изменений и ответственности за обучение',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 6,
                        'competency' => 'learning_agility',
                        'question' => 'Расскажите о ситуации, когда вам нужно было быстро изучить новый товар или бренд.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Не прилагал усилий для обучения, остался некомпетентным',
                            '2' => 'Получил базовые знания, но недостаточно',
                            '3' => 'Изучил необходимую информацию',
                            '4' => 'Быстро глубоко изучил, передал знания клиентам',
                            '5' => 'Достиг экспертного уровня, обучил команду',
                        ],
                        'positive_signals' => [
                            'Проактивно исследовал',
                            'Использовал несколько источников',
                            'Практиковался',
                            'Делился знаниями',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Уклонение от ответственности за обучение',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 7,
                        'competency' => 'integrity',
                        'question' => 'Как вы поступили, когда клиент или коллега попросил вас сделать что-то неуместное?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Согласился с неэтичной просьбой или закрыл глаза',
                            '2' => 'Колебался, не занял чёткую позицию',
                            '3' => 'Вежливо отказал, но не объяснил',
                            '4' => 'Вежливо отказал, объяснил причину, предложил альтернативу',
                            '5' => 'Твёрдая этическая позиция, при необходимости доложил руководству',
                        ],
                        'positive_signals' => [
                            'Чёткая этическая позиция',
                            'Соблюдение правил',
                            'Вежлив, но решителен',
                            'Предложил альтернативу',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_INCONSIST',
                                'trigger_guidance' => 'Ситуативные этические стандарты',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                    [
                        'slot' => 8,
                        'competency' => 'role_competence',
                        'question' => 'Расскажите о ваших ежедневных процессах продаж. Что вы делаете при встрече клиента, анализе потребностей и закрытии сделки?',
                        'method' => 'Direct',
                        'scoring_rubric' => [
                            '1' => 'Не знает базовых навыков продаж, очень ограниченный опыт',
                            '2' => 'Знает некоторые этапы, но с пробелами',
                            '3' => 'Может выполнять стандартный процесс продаж',
                            '4' => 'Знает все этапы, клиентоориентированный подход',
                            '5' => 'Эксперт: техники убеждения, работа с возражениями, допродажи',
                        ],
                        'positive_signals' => [
                            'Клиентоориентированный подход',
                            'Знает этапы процесса',
                            'Описал технику закрытия сделки',
                            'Привёл конкретные примеры',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_INCONSIST',
                                'trigger_guidance' => 'Преувеличение опыта, противоречия в деталях',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                ],
            ],
        ];
    }

    private function warehousePickerTemplate(): array
    {
        return [
            'position_code' => 'warehouse_picker',
            'title' => 'Шаблон интервью — Комплектовщик склада (русский)',
            'json' => [
                'version' => 'v1',
                'language' => 'ru',
                'position' => [
                    'position_code' => 'warehouse_picker',
                    'title_tr' => 'Depo Toplama Elemanı',
                    'title_en' => 'Warehouse Picker',
                    'title_ru' => 'Комплектовщик склада',
                    'category' => 'Логистика',
                    'skill_gate' => [
                        'gate' => 45,
                        'action' => 'HOLD',
                        'safety_critical' => true,
                    ],
                ],
                'questions' => [
                    [
                        'slot' => 1,
                        'competency' => 'communication',
                        'question' => 'Расскажите о ситуации, когда вам нужно было общаться с коллегами или руководителем на складе.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Не общался, не делился информацией',
                            '2' => 'Базовая коммуникация, недостаточная передача информации',
                            '3' => 'Передавал необходимую информацию',
                            '4' => 'Чёткая и своевременная коммуникация, обеспечивал координацию',
                            '5' => 'Проактивный обмен информацией, улучшил координацию в команде',
                        ],
                        'positive_signals' => [
                            'Своевременно делился информацией',
                            'Чёткая и краткая коммуникация',
                            'Отвечал на вопросы',
                            'Получал обратную связь',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Уклонение от коммуникации',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 2,
                        'competency' => 'accountability',
                        'question' => 'Что вы делали, когда собрали не тот товар или произошла ошибка в заказе?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Скрыл ошибку или свалил на другого',
                            '2' => 'Признал ошибку, но не исправил',
                            '3' => 'Сообщил об ошибке, и она была исправлена',
                            '4' => 'Сразу сообщил, выяснил причину, предпринял корректирующие действия',
                            '5' => 'Анализ первопричин, предложил улучшение процесса',
                        ],
                        'positive_signals' => [
                            'Сразу сообщил об ошибке',
                            'Взял ответственность',
                            'Работал над исправлением',
                            'Извлёк уроки',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_BLAME',
                                'trigger_guidance' => 'Перекладывание вины на систему или на других',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                    [
                        'slot' => 3,
                        'competency' => 'teamwork',
                        'question' => 'Расскажите, как вы работали с командой в напряжённый день на складе.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Работал индивидуально, не вносил вклад в команду',
                            '2' => 'Работал в команде, но пассивно',
                            '3' => 'Вносил вклад в команду',
                            '4' => 'Активное сотрудничество, распределение задач',
                            '5' => 'Обеспечивал координацию команды, балансировал нагрузку каждого',
                        ],
                        'positive_signals' => [
                            'Предлагал помощь',
                            'Готов к распределению задач',
                            'Подчёркивал командный успех',
                            'Проявлял гибкость',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_EGO',
                                'trigger_guidance' => 'Выпячивание личных достижений',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 4,
                        'competency' => 'stress_resilience',
                        'question' => 'Как вы работали, когда объём заказов резко вырос и было давление по времени?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Под стрессом увеличились ошибки, упала производительность',
                            '2' => 'С трудом справлялся',
                            '3' => 'Поддерживал приемлемую производительность',
                            '4' => 'Сохранял спокойствие, баланс скорости и точности',
                            '5' => 'Выдающаяся работа под давлением, мотивировал команду',
                        ],
                        'positive_signals' => [
                            'Расставлял приоритеты',
                            'Сохранял спокойствие',
                            'Поддерживал темп',
                            'Избегал ошибок',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_UNSTABLE',
                                'trigger_guidance' => 'Неконтролируемые реакции под стрессом',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 5,
                        'competency' => 'adaptability',
                        'question' => 'Как вы адаптировались, когда на складе внедрили новую систему, маршрут или процедуру?',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Сопротивлялся изменениям',
                            '2' => 'Вынужденно адаптировался',
                            '3' => 'Принял изменения, изучил',
                            '4' => 'Быстро адаптировался',
                            '5' => 'Принял изменения, предложил улучшения',
                        ],
                        'positive_signals' => [
                            'Открыт к обучению',
                            'Пробовал новую систему',
                            'Задавал вопросы',
                            'Давал обратную связь',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Уклонение от изменений',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 6,
                        'competency' => 'learning_agility',
                        'question' => 'Расскажите о ситуации, когда вам нужно было изучить новое складское оборудование или программное обеспечение.',
                        'method' => 'STAR',
                        'scoring_rubric' => [
                            '1' => 'Не прилагал усилий для обучения',
                            '2' => 'Освоил на базовом уровне',
                            '3' => 'Освоил на достаточном уровне',
                            '4' => 'Быстро освоил и начал применять',
                            '5' => 'Стал экспертом, обучил других',
                        ],
                        'positive_signals' => [
                            'Внимательно прошёл обучение',
                            'Практиковался',
                            'Задавал вопросы',
                            'Применял знания на практике',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_AVOID',
                                'trigger_guidance' => 'Уклонение от ответственности за обучение',
                                'severity' => 'medium',
                            ],
                        ],
                    ],
                    [
                        'slot' => 7,
                        'competency' => 'integrity',
                        'question' => 'Что вы делали, когда заметили на складе ситуацию или поведение, нарушающее правила безопасности?',
                        'method' => 'BEI',
                        'scoring_rubric' => [
                            '1' => 'Проигнорировал или сам нарушал правила',
                            '2' => 'Заметил, но не предпринял действий',
                            '3' => 'Предупредил или сообщил',
                            '4' => 'Немедленно вмешался, при необходимости доложил',
                            '5' => 'Защитник культуры безопасности, принимал превентивные меры',
                        ],
                        'positive_signals' => [
                            'Приоритет безопасности',
                            'Соблюдение правил',
                            'Смелость сообщать',
                            'Превентивный подход',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_INCONSIST',
                                'trigger_guidance' => 'Подразумевает, что правила безопасности неважны',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                    [
                        'slot' => 8,
                        'competency' => 'role_competence',
                        'question' => 'Расскажите о ваших ежедневных процессах на складе. Что вы делаете при получении заказа, планировании маршрута, сборке, проверке и упаковке?',
                        'method' => 'Direct',
                        'scoring_rubric' => [
                            '1' => 'Не знает базовых складских процессов',
                            '2' => 'Знает некоторые этапы',
                            '3' => 'Может выполнять стандартный процесс',
                            '4' => 'Знает все этапы, ориентирован на эффективность',
                            '5' => 'Эксперт: оптимизация, работа на погрузчике/рохле, WMS',
                        ],
                        'positive_signals' => [
                            'Знает этапы процесса',
                            'Подчёркивал эффективность',
                            'Знает протоколы безопасности',
                            'Опыт работы с оборудованием',
                        ],
                        'red_flag_hooks' => [
                            [
                                'code' => 'RF_INCONSIST',
                                'trigger_guidance' => 'Преувеличение опыта',
                                'severity' => 'high',
                            ],
                        ],
                    ],
                ],
            ],
        ];
    }
}
